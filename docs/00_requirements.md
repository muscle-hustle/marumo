# marumo 要件定義書

## 1. プロジェクト概要

### 1.1 アプリ名とコンセプト
- **アプリ名**: marumo（まるも）
- **コンセプト**: 「まる」で囲むだけで簡単に「モ」ザイクをかける
- 手軽に顔を保護できるツールを目指す

### 1.2 目的
サーバーに写真を送信せず、クライアント側で安全にモザイク加工できる画像加工アプリケーションを提供する。

### 1.2 基本方針
- **プライバシー重視**: すべての画像処理はクライアント側（ブラウザ）で完結する
- **サーバーレス**: サーバーサイドは静的ファイル配信のみ（画像アップロード不要）
- **ドキュメント重視**: 仕様はドキュメントに明記し、実装後はドキュメントとの整合性を必ずチェックする

## 2. 機能要件

### 2.1 画像選択
- ユーザーがローカルから画像ファイルを選択できる
- **対応画像形式**: JPEG、PNG、WebP（ファイルヘッダーで厳格に検証）
  - 写真用途に特化するため、GIFは除外
- **最大ファイルサイズ**: 10MB
- **最大画像サイズ**: 4K（3840×2160ピクセル）

### 2.2 モザイク加工方法の選択

#### 2.2.1 自動モード
- 画像内の顔を自動検出
- 検出された顔に自動的にモザイク加工を適用
- **顔検出の精度**: 過剰検出しないことを重視。検出不足は手動モードで追加指定することで回避可能

#### 2.2.2 手動モード
- 投げ縄（ラッソ）ツールで範囲を選択
- 選択範囲内の顔を自動判定
- 以下の2つのモードから選択可能：
  - **モザイクする顔を選択**: 選択範囲内の顔にモザイクを適用
  - **モザイクしない顔を選択**: 選択範囲外の顔にモザイクを適用
- **確認事項**:
  - 選択範囲の形状 -> 自由形状のみ
  - 複数範囲の選択可否 -> 不可。選択・自動判定・加工をセットで、必要なら複数回繰り返す。

### 2.3 モザイク加工の種類
以下の3種類から選択可能：
- **モザイク**: ピクセル化処理
- **ぼかし**: ガウシアンブラー等のぼかし処理
- **スタンプ**: スタンプ画像で覆う（WEBで使える顔の絵文字数種のみ、カスタム不可）

**強度設定**:
- 基本的には調整なしでシンプルに利用できることを重視

### 2.4 画像ダウンロード
- 加工済み画像をダウンロードできる
- **ダウンロード形式**: 可能な限り元の形式を維持
- **画像品質**: 元の画像品質を可能な限り維持

## 3. 非機能要件

### 3.1 パフォーマンス
- **処理時間の目標**: 3秒以内
- **対応画像サイズ**: 最大4K（3840×2160ピクセル）まで対応
- メモリ使用量は適切に管理し、ブラウザクラッシュを防ぐ

### 3.2 対応環境
- **対応ブラウザ**: Chrome、Safari、Edge
- **モバイル対応**: スマートフォン、タブレット、PCをサポート
- **レスポンシブデザイン**: 各デバイスに最適化されたUIを提供

### 3.3 セキュリティ・プライバシー
- 画像データは一切サーバーに送信しない
- すべての処理はブラウザ内で完結
- 画像データはメモリ上のみに保持（ローカルストレージには保存しない）

### 3.4 UI/UX
- **デザインの方向性**: ミニマル、シンプル、ユーザーフレンドリー、ポップ
- **レスポンシブデザイン**: スマートフォン、タブレット、PCをサポート
- 直感的で操作しやすいUIを提供

## 4. 技術要件

### 4.1 アーキテクチャ
- **フロントエンド**: 静的サイト（HTML、CSS、JavaScript）
- **サーバーサイド**: 静的ファイル配信のみ（GitHub Pages、Netlify、Vercel等）
- **画像処理**: クライアント側JavaScriptライブラリを使用

### 4.2 使用技術
- **フレームワーク**: React系
- **顔検出ライブラリ**: メジャーでモダンなものを採用（例: MediaPipe Face Detection、face-api.js等）
- **画像処理**: Canvas API等の標準APIを活用

## 5. ドキュメント要件

### 5.1 必須ドキュメント
- 要件定義書（本ドキュメント）
- 技術仕様書
- API仕様書（クライアント側API）
- ユーザーガイド

### 5.2 ドキュメント管理
- ファイル修正後は、必ずドキュメントとの整合性をチェックする
- ドキュメントと実装の不整合を発見した場合は、ドキュメントを更新する

## 6. 今後の展開（オプション）

- 複数画像の一括処理
- 加工履歴の保存（ローカルストレージ）
- プリセット機能（よく使う加工設定の保存）

